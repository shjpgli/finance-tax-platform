<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.abc12366.cms.mapper.db2.ContentRoMapper">

	<!-- 通用查询结果列-->
	<sql id="Base_Column_List">
		contentId,	channelId,	typeId,	modelId,	siteId,	sortDate,	topLevel,	hasTitleImg,	isRecommend,	status,	viewsDay,	commentsDay,	downloadsDay,	upsDay,	recommendLevel
	</sql>

	<!-- 查询（根据主键ID查询） -->
	<select id="selectByPrimaryKey" resultType="com.abc12366.cms.model.Content" parameterType="java.lang.String">
		 SELECT
		 <include refid="Base_Column_List" />
		 FROM cms_content
		 WHERE contentId = #{contentId}
	</select>

	<!-- 查询（根据主键ID查询） -->
	<select id="selectByChannelId" resultType="java.lang.Long" parameterType="java.lang.String">
		SELECT count(contentId) cnt
		FROM cms_content
		WHERE channelId = #{channelId}
	</select>

	<!-- 查询（根据查询条件查询） -->
	<select id="selectList" resultType="com.abc12366.cms.model.bo.ContentListBo" parameterType="java.util.Map">
		SELECT
			a.contentId contentId,
			b.title title,
			b.titleColor titleColor,
			a.channelId channelId,
			c.channelName channelName,
			a.topLevel topLevel,
			a.typeId typeId,
			b.author author,
			e.views views,
			b.releaseDate releaseDate,
			a.status STATUS,
			b.needRegenerate needRegenerate,
			a.recommendLevel recommendLevel
		FROM cms_content a,cms_content_ext b,cms_channel c,cms_content_count e
		WHERE a.contentId = b.contentId AND a.channelId = c.channelId AND a.contentId = e.contentId
		<if test="title != null and title != ''">
			AND b.title like CONCAT('%',#{title},'%')
		</if>
		<if test="author != null and author != ''">
			AND b.author like CONCAT('%',#{author},'%')
		</if>
		<if test="typeId != null and typeId != ''">
			AND a.typeId = #{typeId}
		</if>
		<if test="topLevel != null and topLevel != ''">
			AND a.topLevel = #{topLevel}
		</if>
		<if test="status != null and status != ''">
			AND a.status = #{status}
		</if>
		<if test="recommendLevel != null and recommendLevel != ''">
			AND a.recommendLevel = #{recommendLevel}
		</if>
		<if test="channelId != null and channelId != ''">
			AND a.channelId = #{channelId}
		</if>
		ORDER BY a.topLevel,a.recommendLevel,b.releaseDate DESC
	</select>

	<!-- 查询（根据查询条件查询） -->
	<select id="selectListByChannelId" resultType="com.abc12366.cms.model.bo.ContentsListBo" parameterType="java.util.Map">
		SELECT
		a.contentId contentId,
		b.title title,
		b.titleColor titleColor,
		a.channelId channelId,
		c.channelName channelName,
		a.topLevel topLevel,
		a.typeId typeId,
		b.author author,
		e.views views,
		b.releaseDate releaseDate,
		a.status STATUS,
		b.needRegenerate needRegenerate,
		a.recommendLevel recommendLevel
		FROM cms_content a,cms_content_ext b,cms_channel c,cms_content_count e
		WHERE a.contentId = b.contentId AND a.channelId = c.channelId AND a.contentId = e.contentId
		<if test="typeId != null and typeId != ''">
			AND a.typeId = #{typeId}
		</if>
		<if test="status != null and status != ''">
			AND a.status = #{status}
		</if>
		<if test="channelId != null and channelId != ''">
			AND a.channelId = #{channelId}
		</if>
		<if test="tplContent != null and tplContent != ''">
			AND b.tplContent = #{tplContent}
		</if>
		<if test="startTime!=null and startTime!=''">
			　　AND b.needRegenerate &gt;= #{startTime}
		</if>
		<if test="endTime!=null and endTime!=''">
			　　AND b.needRegenerate &lt;= #{endTime}
		</if>
		ORDER BY a.topLevel,a.recommendLevel,b.releaseDate DESC
	</select>


	<!-- 查询（根据contentId查询） -->
	<select id="selectByContentId" resultType="com.abc12366.cms.model.Content" parameterType="java.lang.String">
		SELECT
		<include refid="Base_Column_List" />
		FROM cms_content
		WHERE contentId = #{contentId}
	</select>



</mapper>