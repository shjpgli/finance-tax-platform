<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.abc12366.uc.mapper.db2.NsrBindQueryRoMapper">

    <select id="selectList" resultType="com.abc12366.uc.model.bo.NsrBindQueryBO"
            parameterType="com.abc12366.uc.model.bo.NsrBindQueryParamBO">
        SELECT a.id,a.username,a.nickname,a.nsrsbh,a.nsrmc,a.swjgmc,a.status,a.createTime,a.lastUpdate, a.bindType from
        (
        SELECT
        uud.id,uu.username,uu.nickname,uud.nsrsbh,uud.nsrmc,uud.swjgmc,uud.status,uud.createTime,uud.lastUpdate,'dzsb'
        bindType
        FROM uc_user uu, uc_user_dzsb uud
        <where>
            uu.id = uud.userId
            <if test="username!=null">
                and uu.username=#{username}
            </if>
            <if test="nsrsbh!=null">
                and uud.nsrsbh=#{nsrsbh}
            </if>
        </where>
        UNION ALL
        SELECT
        uuh.id,uu.username,uu.nickname,uuh.nsrsbh,uuh.nsrmc,uuh.swjgmc,uuh.status,uuh.createTime,uuh.lastUpdate,'hnds'
        bindType
        FROM uc_user uu, uc_user_hnds uuh
        <where>
            uu.id = uuh.userId
            <if test="username!=null">
                and uu.username=#{username}
            </if>
            <if test="nsrsbh!=null">
                and uuh.nsrsbh=#{nsrsbh}
            </if>
        </where>
        UNION ALL
        SELECT
        uuh.id,uu.username,uu.nickname,uuh.nsrsbh,uuh.nsrmc,uuh.swjgmc,uuh.status,uuh.createTime,uuh.lastUpdate,'hngs'
        bindType
        FROM uc_user uu, uc_user_hngs uuh
        <where>
            uu.id = uuh.userId
            <if test="username!=null">
                and uu.username=#{username}
            </if>
            <if test="nsrsbh!=null">
                and uuh.nsrsbh=#{nsrsbh}
            </if>
        </where>
        ) a
        order by createTime desc
    </select>

    <select id="selectDzsb" resultType="com.abc12366.uc.model.bo.UserDzsbBO" parameterType="java.lang.String">
        select id,userId,djxh,nsrsbh,nsrmc,shxydm,swjgMc,swjgDm,status,createTime,lastUpdate
        from uc_user_dzsb
        where id=#{id}
    </select>
    <select id="selectHnds" resultType="com.abc12366.uc.model.bo.UserHndsBO" parameterType="java.lang.String">
        select id,userId,username,subuser,nsrmc,nsrsbh,djxh,shxydm,swjgMc,swjgDm,status,createTime,lastUpdate
        from uc_user_hnds
        where id=#{id}
    </select>
    <select id="selectHngs" resultType="com.abc12366.uc.model.bo.UserHngsBO" parameterType="java.lang.String">
        select id,userId,djxh,nsrsbh,nsrmc,shxydm,swjgMc,swjgDm,bsy,smrzzt,status,createTime,lastUpdate
        from uc_user_hngs
        where id=#{id}
    </select>

</mapper>