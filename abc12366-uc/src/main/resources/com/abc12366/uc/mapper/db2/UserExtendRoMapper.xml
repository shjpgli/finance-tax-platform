<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.abc12366.uc.mapper.db2.UserExtendRoMapper">

    <select id="selectOne" resultType="com.abc12366.uc.model.UserExtend">
        select userId,signature,sex,birthday,bloodType,weight,height,marital, education,graduate,
        occupation,income,postAddress,insert(realName, 1, 1, '*') realName, weixin,qq,safeQuestion,safeAnswer,province,city,area,createTime,
        lastUpdate,tags,insert(idcard, 7, 8, '******') idcard,
        frontImage,backImage,startTime,endTime,validStatus,validTime,remark,careerDuration,validType
        from uc_user_extend
        where userId = #{userId}
    </select>

    <select id="selectList" resultType="com.abc12366.uc.model.bo.UserExtendListBO" parameterType="java.util.Map">
        SELECT userId, signature, sex, birthday, bloodType, weight, height, marital, education, graduate,
        occupation, income, postAddress, realName, weixin, qq, safeQuestion, safeAnswer, province, city,
        area, createTime, lastUpdate, tags, idcard, frontImage, backImage, startTime, endTime, validStatus,
        validTime, remark, careerDuration,validType
        FROM uc_user_extend
        <where>
            <if test="userId != null and userId != ''">
                userId = #{userId}
            </if>
            <if test="realName != null and realName != ''">
                and realName = #{realName}
            </if>
            <if test="validStatus != null and validStatus != ''">
                and validStatus = #{validStatus}
            </if>
            <if test="validType != null and validType != ''">
                and validType = #{validType}
            </if>
        </where>
        order by lastUpdate desc
    </select>

    <select id="isRealName" resultType="com.abc12366.uc.model.UserExtend" parameterType="java.lang.String">
        select validStatus from uc_user_extend where userId =#{userId}
    </select>

    <select id="selectOneForAdmin" resultType="com.abc12366.uc.model.UserExtend">
        select userId,signature,sex,birthday,bloodType,weight,height,marital, education,graduate,
        occupation,income,postAddress,realName, weixin,qq,safeQuestion,safeAnswer,province,city,area,createTime,
        lastUpdate,tags,idcard,
        frontImage,backImage,startTime,endTime,validStatus,validTime,remark,careerDuration,validType
        from uc_user_extend
        where userId = #{userId}
    </select>

    <select id="selectTodoListCount" resultType="java.lang.Integer">
        SELECT count(*) FROM uc_user_extend
        WHERE validStatus = '1'
    </select>
    
    <select id="canmerging" resultType="java.util.Map" parameterType="java.util.Map">
      select id,username,vipLevel,nickname FROM uc_user WHERE EXISTS (
         SELECT userId FROM uc_user_extend
         WHERE userId = uc_user.id AND validStatus = '2' AND idcard=#{idcard} AND userId!=#{userid}
      ) AND status=1  
    </select>
    
</mapper>
